<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Меню</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-2.0.2.min.js"></script>

    <link type="text/css" href="css/navBar/bodyAndFonts.css" rel="stylesheet"/>
    <link type="text/css" href="css/navBar/navBarAllPage.css" rel="stylesheet"/>

    <link type="text/css" href="css/navBar2Pages/navbar2.css" rel="stylesheet"/>
    <link type="text/css" href="css/navBar2Pages/page4.css" rel="stylesheet"/>

    <script src="scripts/navBar2/page4/popUp.js"></script>
    <script src="scripts/navBar2/page4/page4.js"></script>


<!--    ADD FUL CALENDAR-->
    <link href='fullcalendar/packages/core/main.css' rel='stylesheet' />
    <link href='fullcalendar/packages/daygrid/main.css' rel='stylesheet' />

<!--    <link rel="stylesheet" href="css/calendar_with_tasks/bootstrap.min.css">-->
<!--    <link rel="stylesheet" href="css/calendar_with_tasks/style.css">-->

</head>
<body>

<div class="toolbar_menu shadow">
    <div class="tool_left">
        <a href="/" class="block_two_logo">
            <div class="tool_logo1">
                <img src="images/toolbar/logo1.svg" width="100%" />
            </div>
            <div class="tool_logo2">
                <img src="images/toolbar/logo2.svg" width="100%" />
            </div>
        </a>
        <div class="tool_titel">
            {{#tabs}}
                <a href="{{href}}" class="cl_btn_in_navBar"><div class="btn_in_navBar">{{name}}</div></a>
            {{/tabs}}
        </div>
    </div>
    <div class="tool_right">
        <div class="tool_img">
            {{#use_img}}
                <img src="data:image/jpg;base64,{{user_photo}}" class="small_user_photo" />
            {{/use_img}}
            {{#use_default_img}}
                <div class = "user_img_bg">
                    <div class="char_in_img" id="char_in_img">{{first_char}}</div>
                </div>
            {{/use_default_img}}
        </div>
        <div class="tool_user_info">
            <div class="user_name" id="user_name">{{AuthUser.name}} {{AuthUser.last_name}}</div>
            <div class="org">{{role}}</div>
            <div id="user_id" hidden>{{AuthUser.id}}</div>
        </div>
        <div class="tool_btn_log_out">
            <a rel="nofollow" data-method="post" href="/logout">
                <img src="images/toolbar/img_btn_sign_out.svg" width="100%" />
            </a>
        </div>
    </div>
</div>
<div class="navBar2_in">
    <div class="left_btns">
        <a href="/navbar2-1" style="text-decoration: none">
            <div class="btn_in_navBar2_cansel">
                <div class="text_in_navbar2_cansel">КОНДИТЕРСКОЕ<br>ПРОИЗВОДСТВО</div>
            </div>
        </a>
        <a href="/navbar2-2" style="text-decoration: none">
            <div class="btn_in_navBar2_cansel">
                <div class="text_in_navbar2_cansel">ИНФОРМАЦИОННЫЙ ЦЕНТР</div>
            </div>
        </a>
        <a href="/navbar2-3" style="text-decoration: none">
            <div class="btn_in_navBar2_cansel">
                <div class="text_in_navbar2_cansel">МОИ ЗАДАЧИ</div>
            </div>
        </a>
        <a href="/navbar2-4" style="text-decoration: none">
            <div class="btn_in_navBar2_ok">
                <div class="text_in_navbar2_ok">МОИ ЗАЯВКИ</div>
            </div>
        </a>
    </div>
    <div class="right_btns">
        <a href="javascript:useCalendar()">
            <div class="btn_calendar_and_list" id="id_btn_or_in_tasks">
                <img src="images/ic_calendar.svg" class="btn_with_calendar" id="id_img_calendar" style="display: block" width="20px" />
                <img src="images/ic_list.svg" class="btn_with_list" id="id_img_list" width="20px" />
            </div>
        </a>
    </div>
</div>


<div class="task_for_me">

    <div class="task_for_me_filters">
        <div class="forms_to_add_task">
            <div class="forms_block_titel">
                <div class="text_titel_in_forms">ФОРМЫ ДЛЯ ЗАЯВОК</div>
            </div>
            <div class="btns_new_task">
                <a href="javascript:openPageAddTask('TaskIT')" style="text-decoration: none">
                    <div class="btn_add_new_task">
                        <div class="text_in_btn_add_task">IT-отдел</div>
                    </div>
                </a>
                <a href="javascript:openPageAddTask('TaskRepair')" style="text-decoration: none">
                    <div class="btn_add_new_task">
                        <div class="text_in_btn_add_task">Ремонтная служба</div>
                    </div>
                </a>
                <a href="javascript:openPageAddTask('TaskOrder')" style="text-decoration: none">
                    <div class="btn_add_new_task">
                        <div class="text_in_btn_add_task">Закупка канцелярии</div>
                    </div>
                </a>
                <a href="javascript:openPageAddTask('TaskProduct')" style="text-decoration: none">
                    <div class="btn_add_new_task">
                        <div class="text_in_btn_add_task">Заказ продукции</div>
                    </div>
                </a>
                <a href="javascript:openPageAddTask('TaskTransport')" style="text-decoration: none">
                    <div class="btn_add_new_task">
                        <div class="text_in_btn_add_task">Заказ корп. транспорта</div>
                    </div>
                </a>
            </div>
<!--            <a href="#" style="text-decoration: none">-->
<!--                <div class="btn_add_new_form_to_task">-->
<!--                    <div class="text_in_btn_add_form_to_task">Добавить форму для заявок</div>-->
<!--                </div>-->
<!--            </a>-->
        </div>
        <div class="input-group-search_page4" id="id_search" style="margin-right: 15px">
            <input type="text" class="input_search" placeholder="Поиск">
            <div class="input-group-append"><button class="btn btn-primary" style=" display:flex; text-align: center; align-items: center; cursor: pointer">
                <img src="images/ic_search.svg" width="18px" />
            </button></div>
        </div>
        <div id="id_filters">
            <div class="titel_in_filters">
                <div>
                    <img src="images/filter.png" width="18px" />
                </div>
                <div class="text_titel_in_filters">Фильтр</div>
            </div>

            <div class="line_in_filter"></div>


            <!--        Статусы задач:-->
            <div>
                <div>
                    <input type="checkbox" id="scales" name="scales" class="check_box" checked>
                    <label for="scales" class="text_checkbox">Текущие</label>
                </div>

                <div>
                    <input type="checkbox" id="horns" name="horns" class="check_box">
                    <label for="horns" class="text_checkbox">Срочные</label>
                </div>
                <div>
                    <input type="checkbox" id="scales" name="scales" class="check_box">
                    <label for="scales" class="text_checkbox">Просроченные</label>
                </div>

                <div>
                    <input type="checkbox" id="horns" name="horns" class="check_box">
                    <label for="horns" class="text_checkbox">Связанные</label>
                </div>
            </div>

            <div class="btns_in_filter">
                <a href="#" style="text-decoration: none">
                    <div class="btn_filter_type_1">
                        <div class="text_filter_type_1">Применить</div>
                    </div>
                </a>
                <a href="#" style="text-decoration: none">
                    <div class="btn_filter_type_2">
                        <div class="text_filter_type_2">Очистить</div>
                    </div>
                </a>
            </div>
        </div>

    </div>

    <div class="list_my_tasks_sort" id="list_my_all_tasks">

        <div class="titel_in_my_tasks">
            <div class="text_titel_my_task">Отправленные заявки</div>
            <div style="display: flex">
                <a href="#" style="text-decoration: none">
                    <div class="btn_copy_tasks">
                        <div class="text_btn_copy_tasks">Сделать резервную копию</div>
                    </div>
                </a>
            </div>
        </div>

        <table class="table_my_task" id="id_table_my_task">
            <tr class="table_Th">
                <th class="column1">Номер</th>
                <th class="column2">Название</th>
                <th class="column3">Статус</th>
                <th class="column4">Дата добавление</th>
                <th class="column5">Прикреплённый файл</th>
                <th class="column6"></th>
                <th class="column7">Исполнитель</th>
                <th class="column8">Ревизор</th>
                <th class="column9">Главный бухгалтер</th>
                <th class="column10">Юрист</th>
                <th class="column11">Директор</th>
                <th class="column12">История</th>
            </tr>
            {{#MyTasks}}
                <tr class="row_with_info">
                    <td class="column1">{{#id}}{{id}}{{/id}}</td>
                    <td class="column2">{{#name_task}}{{name_task}}{{/name_task}}</td>
                    <td class="column3">{{#status}}{{status}}{{/status}}</td>
                    <td class="column4">{{#date_add}}{{date_add}}{{/date_add}} {{#time_add}}{{time_add}}{{/time_add}}</td>
                    <td class="column5">{{#document.name_file}}{{document.name_file}}{{/document.name_file}}</td>
                    <td class="column6"> </td>
                    <td class="column7">
                        {{#send_to_user1}}
                            <input type="checkbox" id="scales" name="scales" class="check_box" disabled {{#status_user1}}checked{{/status_user1}}>
                        {{/send_to_user1}}
                    </td>
                    <td class="column8">
                        {{#send_to_user2}}
                            <input type="checkbox" id="scales" name="scales" class="check_box" disabled {{#status_user2}}checked{{/status_user2}}>
                        {{/send_to_user2}}
                    </td>
                    <td class="column9">
                        {{#send_to_user3}}
                            <input type="checkbox" id="scales" name="scales" class="check_box" disabled {{#status_user3}}checked{{/status_user3}}>
                        {{/send_to_user3}}
                    </td>
                    <td class="column10">
                        {{#send_to_user4}}
                            <input type="checkbox" id="scales" name="scales" class="check_box" disabled {{#status_user4}}checked{{/status_user4}}>
                        {{/send_to_user4}}
                    </td>
                    <td class="column11">
                        {{#send_to_user5}}
                            <input type="checkbox" id="scales" name="scales" class="check_box" disabled {{#status_user5}}checked{{/status_user5}}>
                        {{/send_to_user5}}
                    </td>
                    <td class="column12">
                        <div style="display: flex;justify-content: center;align-items: center">
                            <a href="javascript:PopUpShowHistory({{#id}}{{id}}{{/id}})" style="text-decoration: none"><img src="images/ic_history.svg" width="18px" /></a>
                        </div>
                    </td>
                </tr>
            {{/MyTasks}}
        </table>

    </div>


    <div class="add_new_task" id="add_new_task">
        <form method="post" class="form_send_task" enctype="multipart/form-data" id="form_to_post_task" action="/addNewUser">
            <div class="form_new_task">
                <div class="titel_new_task">Новая заявка</div>
                <input name="user_id" value="{{AuthUser.id}}" hidden>
                <div>
                    <div class="text_up_input">Название</div>
                    <div class="input2">
                        <input class="input_titel" id="name_task" placeholder="Введите название" name="name_task">
                    </div>
                </div>
                <div class="text_up_input">Описание</div>
                <div class="input2">
                    <textarea class="input_messqge input_info_problem" id="description_input" placeholder="Опишите проблему" name="more_info"></textarea>
                </div>
                <label for="document" class="append">
                    <div class="btn_add_file_to_task" id="btn_add_document">
                        <div class="text_in_btn_add_file">Прикрепить файл</div>
                    </div>
                    <div class="block_add_file" id="block_add_file">
                        <div class="name_use_file" id="name_document"></div>
                        <div>
                            <a href="javascript:delete_file()" style="text-decoration: none;display: flex;align-items: center">
                                <img src="images/ic_cansel_file.png" width="16px" height="16px" />
                            </a>
                        </div>
                    </div>
                    <input type="file" name="doc_file" id="document"/>
                </label>
                <input value="" id="list_users" name="users_array" hidden>
                <div class="btn_add_users" id="id_btn_add_users">
                    <a href="javascript:openWindowAddUsersToSendShow()" class="href_btn_add_user">
                        <div class="text_in_btn_add_file">Отправить следующим сотрудникам</div>
                    </a>
                </div>
                <div class="info_add_users" id="id_info_add_users">
                    <div class="text_select_users" id="text_users_to_send">text</div>
                    <div>
                        <a href="javascript:openWindowAddUsersToSendShow()" style="text-decoration: none">
                            <img src="images/ic_edit.svg" width="26px" height="26px" style="margin-right: 8px" />
                        </a>
                    </div>
                </div>
<!--                <div>-->
<!--                    <div style="margin-top: 5px">-->
<!--                        <input type="checkbox" onclick="clickBox3()" id="checkbox_user_work" name="send_to_user1">-->
<!--                        <label for="scales">Добавить пользователя которому будет отправлена заявка</label>-->
<!--                    </div>-->
<!--                </div>-->
            </div>
            <div class="from_add_small_task" id="block_small_task">
                <div style="display: flex;justify-content: space-between;align-items: center">
                    <div class="titel_new_small_task">Список подзадач</div>
                    <div>
                        <a href="javascript:PopUpShowAddSmallTask()" style="text-decoration: none">
                            <img src="images/add-plus.svg" width="20px" />
                        </a>
                    </div>
                </div>
                <div class="list_all_small_tasks">
                    <div>
                        <img src="images/ic_no_small_task.svg" width="200px" />
                        <div class="text_no_small_tasks">Список подзадач пуст</div>
                    </div>
                </div>

            </div>
            <div class="add_users_to_task" id="block_add_users">
                <div style="display: flex;justify-content: space-between;align-items: center">
                    <div class="titel_users">Выберите пользователей для отправки на подпись</div>
                    <div>
                    </div>
                </div>
                <div style="margin-top: 20px;margin-left: 20px">
                    <div style="margin-top: 5px">
                        <input type="checkbox" id="scales" name="send_to_user2">
                        <label for="scales">Ревизор</label>
                    </div>
                    <div style="margin-top: 5px">
                        <input type="checkbox" id="scales" name="send_to_user4">
                        <label for="scales">Юрист</label>
                    </div>
                    <div style="margin-top: 5px">
                        <input name="id_user_to_send" id="id_user_send2" hidden>
                        <input type="checkbox" onclick="clickBox3()" id="checkbox_user_work" name="send_to_user1">
                        <label for="scales">Исполнитель</label>
                    </div>
                    <script>
                        var ddData = [
                            {
                                text: "Значение по умолчанию",
                                value: 0,
                                description: " "
                            }
                            {{#list_users}}
                                ,{
                                    text: "{{#last_name}}{{last_name}}{{/last_name}} {{#name}}{{name}}{{/name}} {{#patronymic}}{{patronymic}}{{/patronymic}}",
                                    value: {{#id}}{{id}}{{/id}},
                                    description: "Роль:{{#role}}{{role}}{{/role}} ",
                                    imageSrc: "https://i.imgur.com/XkuTj3B.png"
                                }
                            {{/list_users}}

                        ];
                    </script>
                    <div class="block_add_user" id="block_user_select">
                        <div class="text_up_input">Выберите исполнителя</div>
                        <div>
                            <select name="" id="select_user"></select>
                        </div>
                    </div>
                    <div style="margin-top: 5px">
                        <input type="checkbox" id="scales" name="send_to_user3">
                        <label for="scales">Главный бухгалтер</label>
                    </div>
                    <div style="margin-top: 5px">
                        <input type="checkbox" id="scales" name="send_to_user5">
                        <label for="scales">Директор</label>
                    </div>
                </div>
            </div>
            <div class="btn_save_and_cansel">
                <div style="text-decoration: none; margin-right: 20px">
                    <button class="btn_add_task" type="submit">
                        <div class="text_filter_type_1">Сохранить</div>
                    </button>
                </div>
                <a href="/navbar2-4" style="text-decoration: none">
                    <div class="btn_cansel">
                        <div class="text_filter_type_2">Отмена</div>
                    </div>
                </a>
            </div>
        </form>
    </div>


    <div class="big_calendar" id="id_full_calendar">
        <div class="box_for_calendar" id='calendar-container'>
            <div id='calendar'></div>
        </div>



        <script src="scripts/big_calendar/jquery-3.3.1.min.js"></script>
        <script src="scripts/big_calendar/popper.min.js"></script>
        <script src="scripts/big_calendar/bootstrap.min.js"></script>

        <script src='fullcalendar/packages/core/main.js'></script>
        <script src='fullcalendar/packages/interaction/main.js'></script>
        <script src='fullcalendar/packages/daygrid/main.js'></script>
        <script src='fullcalendar/packages/timegrid/main.js'></script>
        <script src='fullcalendar/packages/list/main.js'></script>

        <script>
            document.addEventListener('DOMContentLoaded', function() {
                var calendarEl = document.getElementById('calendar');

                var calendar = new FullCalendar.Calendar(calendarEl, {
                    plugins: [ 'interaction', 'dayGrid', 'timeGrid', 'list' ],
                    height: 'parent',
                    header: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'dayGridMonth,timeGridWeek,timeGridDay'
                    },
                    defaultView: 'dayGridMonth',
                    defaultDate: '{{#date_now}}{{date_now}}{{/date_now}}{{^date_now}}2023-01-01{{/date_now}}',
                    navLinks: true, // can click day/week names to navigate views
                    editable: true,
                    eventLimit: true, // allow "more" link when too many events
                    events: [
                        {{#MyTasks}}
                            {
                                title: '{{#name_task}}{{name_task}}{{/name_task}}',
                                start: '2023-01-01',
                                end: '2023-01-03'
                            },
                        {{/MyTasks}}
                        // {
                        //     title: 'Заявка 5',
                        //     start: '2022-12-12T10:30:00',
                        //     end: '2022-12-12T12:30:00'
                        // }
                        {
                        }
                    ]
                });

                calendar.render();
            });

        </script>

        <script src="scripts/big_calendar/main.js"></script>
    </div>

</div>

<div class="b-popup-users" id="popUpUsers">
    <div class="b-popup-content-users">
        <div class="titel_block">
            <div class="text_titel_hist">Отправить пользователям</div>
            <div class="block_cl">
                <a href="javascript:openWindowAddUsersToSendHide()" style="text-decoration: none"><img src="images/ic_cl_btn.svg" width="20px" height="20px" /></a>
            </div>
        </div>
        <div class="block_list_users" id="users_list">
            {{#list_users}}
                <div class="item_user">
                    <input value="{{#id}}{{id}}{{/id}}" hidden>
                    <div class="user_info_in_list">
                        <div class="user_photo_in_list">
                            {{#photo.res}}
                                <img src="/getUserPhoto?user_id={{id}}" class="img_user_in_list">
                            {{/photo.res}}
                            {{^photo.res}}

                                <div class="user_no_photo_in_list">
                                    <div class="char_in_img" id="char_in_img">{{#name}}{{name}}{{/name}}</div>
                                </div>
                            {{/photo.res}}
                        </div>
                        <div class="block_fio">
                            <div class="item_text_fio">{{#last_name}}{{last_name}}{{/last_name}} {{#name}}{{name}}{{/name}} {{#patronymic}}{{patronymic}}{{/patronymic}}</div>
                            <div class="item_user_role">{{#role}}{{role}}{{/role}}</div>
                        </div>
                    </div>
                    <div class="btn_add_user">
                        <div class="btn_select_user" id="btn_select_user_{{#id}}{{id}}{{/id}}">
                            <a href="javascript:addUserInTask({{#id}}{{id}}{{/id}})" style="text-decoration: none">
                                <img src="images/ic_done.svg" width="20px" height="20px" />
                            </a>
                        </div>
                        <div class="btn_cansel_user" id="btn_cansel_user_{{#id}}{{id}}{{/id}}">
                            <a href="javascript:deleteUserInTask({{#id}}{{id}}{{/id}})" style="text-decoration: none">
                                <img src="images/ic_cl_btn.svg" width="20px" height="20px" />
                            </a>
                        </div>
                    </div>

                </div>
                <div class="line_in_list"></div>
            {{/list_users}}
        </div>
        <div class="block_with_btn_add_users">
            <a href="javascript:addUsersInArray()" style="text-decoration: none">
                <div class="btn_add_users_in_task">
                    <div class="text_btn_add_users">Сохранить</div>
                </div>
            </a>
        </div>

    </div>
</div>

<div class="b-popup" id="popUpHistory">
    <div class="b-popup-content">
        <div class="titel_block">
            <div class="text_titel_hist">История</div>
            <div class="block_cl">
                <a href="javascript:PopUpHideHistory()" style="text-decoration: none"><img src="images/ic_cl_btn.svg" width="20px" height="20px" /></a>
            </div>
        </div>
        <div class="block_history_info" id="history_list">
        </div>

    </div>
</div>


<div class="b-popup_small_task" id="popUpAddSmallTask">
    <div class="b-popup-content_small_task">
        <div class="titel_block">
            <div class="text_titel_hist">Добавление подзадачи</div>
            <div class="block_cl">
                <a href="javascript:PopUpHideAddSmallTask()" style="text-decoration: none"><img src="images/ic_cl_btn.svg" width="20px" height="20px" /></a>
            </div>
        </div>
        <div style="margin-left: 20px;margin-right: 20px">
            <div class="text_up_input">Название</div>
            <div class="input2">
                <input class="input_titel" id="name_task" placeholder="Введите название">
            </div>
            <div class="text_up_input">Описание</div>
            <div class="input2">
                <textarea class="input_messqge input_info_problem_small_task" id="description_input" placeholder="Опишите проблему"></textarea>
            </div>
        </div>
        <div class="block_with_btn_add_new_small_task">
            <a href="#" style="text-decoration: none">
                <div class="btn_add_small_task">
                    <div class="text_filter_type_1">Добавить</div>
                </div>
            </a>
        </div>
    </div>
</div>

<script src="scripts/navBar2/page4/selectUser.js"></script>


</body>
</html>